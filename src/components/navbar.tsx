import Image from "next/image";
import Link from "next/link";
import { useState, useEffect } from "react";
import ProfileButton from "@/components/profileButton";
import React from "react";
import Router from "next/router";
import { useLocation } from "react-router-dom";
import LoginButton from "@/components/loginButton";
import { motion } from "framer-motion";
import { useRouter } from "next/router";
import { useSession } from "next-auth/react";


export default function Navbar(
   props: any = {
      transparent: false,
      login: false,
      home: false,
      place: "",
      about: false,
   }
) {
   const { data : session } = useSession();
   
   const { transparent } = props;
   let navBackground = "bg-white drop-shadow";
   let logoColor = "text-[#B17C3F]";
   let searchRing =
      " placeholder:text-[#B17C3F] focus:outline-none focus:border-[#B17C3F] focus:ring-2 focus:ring-[#B17C3F] ";
   let searchBackground = "bg-[#F1F1F1]";
   let searchTextColor = "text-[#B17C3F]";
   let btnTextColor = "text-[#B17C3F]";
   let btnColor = "bg-[#E4D1BC]";
   let textColor = "text-[#CAC5C5] hover:text-[#B17C3F]";
   let loginTextBtnColor = "text-white";
   let loginBtnColor = "bg-[#B17C3F]";
   let profileTextColor = "text-black";
   let homie = " sticky top-0";
   if (props.home) homie = " fixed";
   if (props.about) homie = " ";
   if (props.transparent) {
      navBackground = "bg-transparent";
      logoColor = "text-white";
      searchRing = " border-white border-[1px] placeholder:text-white ";
      searchBackground = "bg-transparent";
      searchTextColor = "text-white";
      btnTextColor = "text-[#559CB2]";
      btnColor = "bg-white";
      textColor = "text-white";
      loginTextBtnColor = "text-[#569DB3]";
      loginBtnColor = "bg-white";
      profileTextColor = "text-white";
   }

   function clickHandler(link: string) {
      return Router.push(link);
   }
   type NavItemType = {
      label: string;
      link: string;
   };
   const NavItem = ({ label, link }: NavItemType) => {
      {
         // const {pathname}  = useLocation();
         // const [pathname, setPathname] = useState("");
         // useEffect(() => {
         //   setPathname(window.location.pathname);
         // }, []);
         const pathname = useRouter().pathname;
         // let pathname = window.location.pathname;

         let param = "h-11 w-32 rounded-full font-light " + textColor;
         let button =
            " h-11 w-32 rounded-full top-[22%] absolute -z-10" + btnColor;
         if (pathname === link)
            button =
               "h-11 w-32 rounded-full top-[22%] absolute -z-10 " + btnColor;
         if (pathname === link)
            param =
               "h-11 w-32 rounded-full text-xl font-normal " +
               btnTextColor +
               " ";

         return (
            <div>
               <button onClick={() => clickHandler(link)} className={param}>
                  {label}
               </button>
               {pathname === link && (
                  <motion.div
                     layoutId="underline"
                     transition={{ duration: 0.4 }}
                     className={button + " underline"}
                  ></motion.div>
               )}
            </div>
         );
      }
   };

   return (
      <nav
         className={
            "z-50 flex h-20 w-full items-center justify-center text-xl text-black transition-colors duration-300 " +
            navBackground +
            homie
         }
      >
         <div className="flex w-full justify-between px-12">
            <div className="w-28">
               <svg
                  className={
                     "h-full w-full fill-current object-contain " + logoColor
                  }
                  width="109"
                  height="35"
                  viewBox="0 0 109 35"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
               >
                  <path d="M26.3682 0.894531C25.9443 1.55078 25.4316 2.16602 24.8301 2.74023C24.2285 3.31445 23.5723 3.82031 22.8613 4.25781C22.1504 4.69531 21.3984 5.04395 20.6055 5.30371C19.8125 5.5498 19.0195 5.67285 18.2266 5.67285L14.1865 5.71387C13.6396 6.37012 13.2363 7.00586 12.9766 7.62109C12.7168 8.23633 12.5869 8.96094 12.5869 9.79492V15.5371H13.1816C13.7285 15.5371 14.3916 15.5508 15.1709 15.5781C15.9502 15.5918 16.7363 15.5713 17.5293 15.5166C18.3359 15.4619 19.1016 15.3457 19.8262 15.168C20.5508 14.9766 21.1387 14.6826 21.5898 14.2861L22.082 14.8809C21.6582 15.5234 21.1455 16.0635 20.5439 16.501C19.9424 16.9385 19.2861 17.3008 18.5752 17.5879C17.8643 17.8613 17.1123 18.0664 16.3193 18.2031C15.5264 18.3262 14.7334 18.3945 13.9404 18.4082H12.5869V26.2217C12.5869 28.04 12.1973 29.6533 11.418 31.0615C10.6387 32.4834 9.50391 33.707 8.01367 34.7324L7.2959 33.9326C7.52832 33.6729 7.71289 33.3789 7.84961 33.0508C7.98633 32.7227 8.08887 32.3809 8.15723 32.0254C8.23926 31.6699 8.28711 31.3145 8.30078 30.959C8.32812 30.5898 8.3418 30.2412 8.3418 29.9131V18.4082H4.36328L6.53711 15.5371H8.3418V12.1738C8.3418 11.5312 8.47168 10.9092 8.73145 10.3076C9.00488 9.69238 9.34668 9.11133 9.75684 8.56445C10.167 8.01758 10.6182 7.50488 11.1104 7.02637C11.6025 6.54785 12.0811 6.11035 12.5459 5.71387C11.9717 5.71387 11.4248 5.71387 10.9053 5.71387C10.3994 5.7002 9.88672 5.69336 9.36719 5.69336C8.84766 5.69336 8.31445 5.69336 7.76758 5.69336C7.2207 5.67969 6.61914 5.67285 5.96289 5.67285C5.44336 5.67285 4.97852 5.72754 4.56836 5.83691C4.17188 5.93262 3.80273 6.07617 3.46094 6.26758C3.11914 6.45898 2.79102 6.69824 2.47656 6.98535C2.16211 7.27246 1.84082 7.60742 1.5127 7.99023L0.917969 7.35449C1.38281 6.71191 1.93652 6.05566 2.5791 5.38574C3.22168 4.70215 3.91211 4.08008 4.65039 3.51953C5.40234 2.95898 6.18848 2.50098 7.00879 2.14551C7.84277 1.77637 8.68359 1.5918 9.53125 1.5918H17.4678C18.001 1.5918 18.6572 1.58496 19.4365 1.57129C20.2158 1.55762 21.0088 1.5166 21.8154 1.44824C22.6221 1.36621 23.3877 1.24316 24.1123 1.0791C24.8369 0.901367 25.418 0.655273 25.8555 0.34082L26.3682 0.894531ZM40.0674 28.5596C39.9033 28.915 39.6982 29.25 39.4521 29.5645C39.2061 29.8789 38.9189 30.1592 38.5908 30.4053C38.2764 30.6514 37.9277 30.8496 37.5449 31C37.1758 31.1367 36.7861 31.2051 36.376 31.2051C35.2959 31.2051 34.5166 30.9111 34.0381 30.3232C33.5732 29.7217 33.3408 28.9082 33.3408 27.8828V27.5137C33.0947 27.9785 32.8145 28.4434 32.5 28.9082C32.1992 29.373 31.8506 29.79 31.4541 30.1592C31.0713 30.5283 30.6406 30.8291 30.1621 31.0615C29.6836 31.2939 29.1504 31.4102 28.5625 31.4102C27.6738 31.4102 26.8877 31.2393 26.2041 30.8975C25.5205 30.5557 24.9463 30.0977 24.4814 29.5234C24.0166 28.9355 23.668 28.252 23.4355 27.4727C23.2031 26.6934 23.0869 25.8662 23.0869 24.9912C23.0869 23.8018 23.292 22.6191 23.7021 21.4434C24.126 20.2539 24.7139 19.1943 25.4658 18.2646C26.2314 17.335 27.1406 16.583 28.1934 16.0088C29.2598 15.4209 30.4424 15.127 31.7412 15.127C32.2607 15.127 32.7803 15.1748 33.2998 15.2705C33.8193 15.3662 34.3115 15.5234 34.7764 15.7422C35.2549 15.9473 35.6855 16.2207 36.0684 16.5625C36.4648 16.9043 36.7861 17.3213 37.0322 17.8135L33.9766 19.1055C33.8125 18.8457 33.6211 18.5996 33.4023 18.3672C33.1973 18.1211 32.9648 17.9092 32.7051 17.7314C32.459 17.5537 32.1924 17.4102 31.9053 17.3008C31.6182 17.1914 31.3174 17.1367 31.0029 17.1367C30.292 17.1367 29.6562 17.3555 29.0957 17.793C28.5488 18.2305 28.0771 18.7705 27.6807 19.4131C27.2979 20.0557 27.0039 20.7393 26.7988 21.4639C26.5938 22.1885 26.4912 22.8447 26.4912 23.4326C26.4912 23.9521 26.5391 24.54 26.6348 25.1963C26.7441 25.8389 26.9287 26.4473 27.1885 27.0215C27.4482 27.5957 27.79 28.0811 28.2139 28.4775C28.6377 28.874 29.1709 29.0723 29.8135 29.0723C30.3193 29.0723 30.7568 28.9629 31.126 28.7441C31.4951 28.5117 31.8096 28.2178 32.0693 27.8623C32.3291 27.4932 32.541 27.0762 32.7051 26.6113C32.8828 26.1328 33.0127 25.6475 33.0947 25.1553C33.1904 24.6631 33.252 24.1777 33.2793 23.6992C33.3203 23.207 33.3408 22.7695 33.3408 22.3867V20.9717L37.0732 19.6592V27.9854C37.0732 28.2588 37.1416 28.5117 37.2783 28.7441C37.415 28.9629 37.627 29.0723 37.9141 29.0723C38.2559 29.0723 38.5635 28.9492 38.8369 28.7031C39.124 28.4434 39.3496 28.1836 39.5137 27.9238L40.0674 28.5596ZM48.9883 31.5537C48.8242 31.5537 48.6533 31.5127 48.4756 31.4307C48.3115 31.3623 48.1885 31.2461 48.1064 31.082L42.8975 19.3721C42.8291 19.249 42.7471 19.1123 42.6514 18.9619C42.5693 18.7979 42.4668 18.6475 42.3438 18.5107C42.2207 18.374 42.084 18.2578 41.9336 18.1621C41.7832 18.0664 41.626 18.0186 41.4619 18.0186C41.2295 18.0186 41.0312 18.1074 40.8672 18.2852C40.7031 18.4492 40.5527 18.627 40.416 18.8184L40.0059 18.2646C40.1426 17.8545 40.334 17.4648 40.5801 17.0957C40.8398 16.7129 41.1406 16.3779 41.4824 16.0908C41.8242 15.8037 42.2002 15.5713 42.6104 15.3936C43.0205 15.2158 43.4512 15.127 43.9023 15.127C44.2441 15.127 44.5518 15.2432 44.8252 15.4756C45.0986 15.6943 45.3379 15.9678 45.543 16.2959C45.7617 16.624 45.9463 16.9658 46.0967 17.3213C46.2607 17.6768 46.3975 17.9775 46.5068 18.2236C47.1631 19.7959 47.8125 21.3545 48.4551 22.8994C49.1113 24.4443 49.7812 25.9824 50.4648 27.5137L53.0283 22.2637C53.1377 22.0723 53.2129 21.8125 53.2539 21.4844C53.2949 21.1562 53.3154 20.8828 53.3154 20.6641C53.3154 19.8574 53.1104 19.1602 52.7002 18.5723C52.29 17.9707 51.7227 17.4922 50.998 17.1367L53.3564 13.8965C54.1221 14.2793 54.6826 14.7988 55.0381 15.4551C55.4072 16.0977 55.5918 16.8428 55.5918 17.6904C55.5918 18.1143 55.5371 18.5859 55.4277 19.1055C55.332 19.6113 55.1885 20.0625 54.9971 20.459L49.7881 31.123C49.583 31.4102 49.3164 31.5537 48.9883 31.5537ZM72.4082 27.001C71.9297 27.6162 71.4033 28.1904 70.8291 28.7236C70.2686 29.2568 69.6533 29.7217 68.9834 30.1182C68.3271 30.5146 67.6299 30.8291 66.8916 31.0615C66.1533 31.2939 65.3877 31.4102 64.5947 31.4102C63.583 31.4102 62.6533 31.2324 61.8057 30.877C60.958 30.5078 60.2266 30.0088 59.6113 29.3799C58.9961 28.7373 58.5176 27.9854 58.1758 27.124C57.834 26.249 57.6631 25.3125 57.6631 24.3145C57.6631 23.4941 57.7793 22.6875 58.0117 21.8945C58.2441 21.1016 58.5723 20.3564 58.9961 19.6592C59.4199 18.9619 59.9189 18.3193 60.4932 17.7314C61.0811 17.1299 61.7236 16.6172 62.4209 16.1934C63.1182 15.7695 63.8564 15.4414 64.6357 15.209C65.415 14.9629 66.2148 14.8398 67.0352 14.8398C67.6094 14.8398 68.1494 14.9082 68.6553 15.0449C69.1748 15.1816 69.6328 15.4004 70.0293 15.7012C70.4258 15.9883 70.7402 16.3643 70.9727 16.8291C71.2051 17.2803 71.3213 17.8203 71.3213 18.4492C71.3213 18.9688 71.1641 19.5156 70.8496 20.0898C70.5488 20.6641 70.1455 21.2383 69.6396 21.8125C69.1475 22.3867 68.5869 22.9541 67.958 23.5146C67.3291 24.0615 66.6865 24.5742 66.0303 25.0527C65.3877 25.5176 64.7656 25.9277 64.1641 26.2832C63.5625 26.6387 63.0361 26.9121 62.585 27.1035C63.0908 27.7324 63.6787 28.2451 64.3486 28.6416C65.0186 29.0381 65.7295 29.2363 66.4814 29.2363C66.96 29.2363 67.4453 29.1475 67.9375 28.9697C68.4297 28.7783 68.9014 28.5391 69.3525 28.252C69.8174 27.9648 70.2549 27.6504 70.665 27.3086C71.0889 26.9668 71.4648 26.6455 71.793 26.3447L72.4082 27.001ZM67.4658 19.208C67.4658 18.8936 67.4111 18.5928 67.3018 18.3057C67.2061 18.0186 67.0625 17.7725 66.8711 17.5674C66.6797 17.3486 66.4473 17.1777 66.1738 17.0547C65.9141 16.918 65.6133 16.8496 65.2715 16.8496C64.6562 16.8496 64.0889 17.0684 63.5693 17.5059C63.0498 17.9297 62.5986 18.4561 62.2158 19.085C61.8467 19.7139 61.5527 20.3838 61.334 21.0947C61.1289 21.792 61.0264 22.4072 61.0264 22.9404C61.0264 23.46 61.1084 23.9932 61.2725 24.54C61.4365 25.0869 61.6621 25.6133 61.9492 26.1191C62.4961 25.8184 63.0908 25.4014 63.7334 24.8682C64.376 24.335 64.9707 23.7539 65.5176 23.125C66.0781 22.4824 66.543 21.8193 66.9121 21.1357C67.2812 20.4521 67.4658 19.8096 67.4658 19.208ZM82.4365 28.6006C82.2725 28.9561 82.0605 29.291 81.8008 29.6055C81.5547 29.9199 81.2744 30.2002 80.96 30.4463C80.6455 30.6924 80.2969 30.8838 79.9141 31.0205C79.5449 31.1709 79.1621 31.2461 78.7656 31.2461C77.6992 31.2461 76.9199 30.9521 76.4277 30.3643C75.9492 29.7627 75.71 28.9492 75.71 27.9238V2.9043L79.4834 1.5918V28.0264C79.4834 28.2998 79.5449 28.5527 79.668 28.7852C79.791 29.0039 80.0098 29.1133 80.3242 29.1133C80.6387 29.1133 80.9326 28.9902 81.2061 28.7441C81.4932 28.4844 81.7188 28.2314 81.8828 27.9854L82.4365 28.6006ZM101.058 28.5596C100.894 28.915 100.688 29.25 100.442 29.5645C100.196 29.8789 99.9092 30.1592 99.5811 30.4053C99.2666 30.6514 98.918 30.8496 98.5352 31C98.166 31.1367 97.7764 31.2051 97.3662 31.2051C96.2861 31.2051 95.5068 30.9111 95.0283 30.3232C94.5635 29.7217 94.3311 28.9082 94.3311 27.8828V27.5137C94.085 27.9785 93.8047 28.4434 93.4902 28.9082C93.1895 29.373 92.8408 29.79 92.4443 30.1592C92.0615 30.5283 91.6309 30.8291 91.1523 31.0615C90.6738 31.2939 90.1406 31.4102 89.5527 31.4102C88.6641 31.4102 87.8779 31.2393 87.1943 30.8975C86.5107 30.5557 85.9365 30.0977 85.4717 29.5234C85.0068 28.9355 84.6582 28.252 84.4258 27.4727C84.1934 26.6934 84.0771 25.8662 84.0771 24.9912C84.0771 23.8018 84.2822 22.6191 84.6924 21.4434C85.1162 20.2539 85.7041 19.1943 86.4561 18.2646C87.2217 17.335 88.1309 16.583 89.1836 16.0088C90.25 15.4209 91.4326 15.127 92.7314 15.127C93.251 15.127 93.7705 15.1748 94.29 15.2705C94.8096 15.3662 95.3018 15.5234 95.7666 15.7422C96.2451 15.9473 96.6758 16.2207 97.0586 16.5625C97.4551 16.9043 97.7764 17.3213 98.0225 17.8135L94.9668 19.1055C94.8027 18.8457 94.6113 18.5996 94.3926 18.3672C94.1875 18.1211 93.9551 17.9092 93.6953 17.7314C93.4492 17.5537 93.1826 17.4102 92.8955 17.3008C92.6084 17.1914 92.3076 17.1367 91.9932 17.1367C91.2822 17.1367 90.6465 17.3555 90.0859 17.793C89.5391 18.2305 89.0674 18.7705 88.6709 19.4131C88.2881 20.0557 87.9941 20.7393 87.7891 21.4639C87.584 22.1885 87.4814 22.8447 87.4814 23.4326C87.4814 23.9521 87.5293 24.54 87.625 25.1963C87.7344 25.8389 87.9189 26.4473 88.1787 27.0215C88.4385 27.5957 88.7803 28.0811 89.2041 28.4775C89.6279 28.874 90.1611 29.0723 90.8037 29.0723C91.3096 29.0723 91.7471 28.9629 92.1162 28.7441C92.4854 28.5117 92.7998 28.2178 93.0596 27.8623C93.3193 27.4932 93.5312 27.0762 93.6953 26.6113C93.873 26.1328 94.0029 25.6475 94.085 25.1553C94.1807 24.6631 94.2422 24.1777 94.2695 23.6992C94.3105 23.207 94.3311 22.7695 94.3311 22.3867V20.9717L98.0635 19.6592V27.9854C98.0635 28.2588 98.1318 28.5117 98.2686 28.7441C98.4053 28.9629 98.6172 29.0723 98.9043 29.0723C99.2461 29.0723 99.5537 28.9492 99.8271 28.7031C100.114 28.4434 100.34 28.1836 100.504 27.9238L101.058 28.5596ZM108.051 29.4414C108.051 29.7695 107.982 30.0771 107.846 30.3643C107.723 30.6514 107.552 30.8975 107.333 31.1025C107.128 31.3213 106.875 31.4922 106.574 31.6152C106.287 31.7383 105.979 31.7998 105.651 31.7998C105.323 31.7998 105.016 31.7383 104.729 31.6152C104.455 31.4922 104.209 31.3213 103.99 31.1025C103.771 30.8975 103.601 30.6514 103.478 30.3643C103.354 30.0771 103.293 29.7695 103.293 29.4414C103.293 29.1133 103.354 28.8057 103.478 28.5186C103.601 28.2314 103.771 27.9785 103.99 27.7598C104.209 27.541 104.455 27.3701 104.729 27.2471C105.016 27.1104 105.323 27.042 105.651 27.042C105.979 27.042 106.287 27.1104 106.574 27.2471C106.875 27.3701 107.128 27.541 107.333 27.7598C107.552 27.9785 107.723 28.2314 107.846 28.5186C107.982 28.8057 108.051 29.1133 108.051 29.4414Z" />
               </svg>
            </div>
            <div className="flex items-center justify-center space-x-12">
               <div className="flex items-center justify-center space-x-4">
                  <form className="h-12 w-[35rem]" action="">
                     <div className="float-right pr-12">
                        <svg
                           className={
                              "absolute mt-2 fill-current " + searchTextColor
                           }
                           width="28"
                           height="28"
                           viewBox="0 0 28 28"
                           xmlns="http://www.w3.org/2000/svg"
                        >
                           <path d="M22.0965 20.1475L28 26.0496L26.0496 28L20.1475 22.0965C17.9514 23.857 15.2199 24.8145 12.4052 24.8105C5.55755 24.8105 0 19.2529 0 12.4052C0 5.55755 5.55755 0 12.4052 0C19.2529 0 24.8105 5.55755 24.8105 12.4052C24.8145 15.2199 23.857 17.9514 22.0965 20.1475ZM19.3315 19.1247C21.0808 17.3258 22.0577 14.9144 22.0538 12.4052C22.0538 7.07512 17.7354 2.75672 12.4052 2.75672C7.07512 2.75672 2.75672 7.07512 2.75672 12.4052C2.75672 17.7354 7.07512 22.0538 12.4052 22.0538C14.9144 22.0577 17.3258 21.0808 19.1247 19.3315L19.3315 19.1247Z" />
                        </svg>
                     </div>
                     <input
                        type="text"
                        className={
                           "+ h-full w-full rounded-full pl-5 text-xl font-light " +
                           searchTextColor +
                           " placeholder:" +
                           searchTextColor +
                           " focus:outline-none " +
                           searchBackground +
                           searchRing +
                           "caret-pink-600"
                        }
                        placeholder="Search..."
                     ></input>
                  </form>
                  <NavItem label="Home" link="/"></NavItem>
                  <NavItem label="Browse" link="/browse"></NavItem>
                  <NavItem label="Build" link="/build"></NavItem>
                  <NavItem label="About" link="/aboutUs"></NavItem>
               </div>
               {session ? (
                  <ProfileButton transparent={transparent}></ProfileButton>
               ) : (
                  <LoginButton transparent={transparent}></LoginButton>
               )}
            </div>
         </div>
         {/* mobile nav */}
      </nav>
   );
}
